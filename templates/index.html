<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üß† Identifica√ß√£o Biom√©trica em V√≠deo</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom right, #e6f0ff, #cce0ff);
      margin: 0;
      padding: 0;
      color: #333;
    }
    .container {
      max-width: 960px;
      margin: 40px auto;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #004080;
      margin-bottom: 10px;
    }
    .descricao {
      text-align: center;
      color: #333;
      margin-bottom: 30px;
      font-size: 1rem;
      line-height: 1.5;
    }
    form {
      background: #ffffff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 40px;
    }
    .drop-section {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .drop-box {
      flex: 1 1 45%;
      border: 2px dashed #4da6ff;
      border-radius: 10px;
      padding: 30px;
      text-align: center;
      background-color: #f9fbff;
      cursor: pointer;
      transition: background-color 0.2s ease;
      min-height: 150px;
      position: relative;
    }
    .drop-box:hover {
      background-color: #edf5ff;
    }
    .drop-box input[type='file'] {
      display: none;
    }
    .drop-box p {
      font-size: 1.1em;
      color: #004080;
    }
    button {
      width: 100%;
      padding: 14px;
      font-size: 16px;
      background-color: #4da6ff;
      border: none;
      border-radius: 8px;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #3399ff;
    }
    .card {
      background: #fff;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .match {
      border-left: 6px solid #4caf50;
    }
    .no-match {
      border-left: 6px solid #f44336;
    }
    .score {
      font-weight: bold;
      margin-bottom: 10px;
      color: #333;
    }
    .images {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }
    img {
      max-width: 180px;
      border-radius: 6px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.05);
    }
    @media (max-width: 600px) {
      .drop-box {
        flex: 1 1 100%;
      }
      .images {
        flex-direction: column;
        align-items: center;
      }
    }
    #progress-bar-container {
      display: none;
      margin-top: 20px;
    }
    .progress-bar-wrapper {
      width: 100%;
      background-color: #dbefff;
      border-radius: 8px;
      overflow: hidden;
      height: 14px;
    }
    .progress-bar {
      width: 0%;
      height: 100%;
      background-color: #4da6ff;
      animation: progressIndeterminate 2s linear infinite;
    }
    @keyframes progressIndeterminate {
      0% {
        width: 0%;
      }
      50% {
        width: 75%;
      }
      100% {
        width: 0%;
      }
    }
    .file-status {
      margin-top: 8px;
      font-size: 0.9em;
      color: green;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üß† Identifica√ß√£o Biom√©trica em V√≠deo</h1>
    <div class="descricao">
      Este prot√≥tipo funcional permite identificar pessoas em v√≠deos com base em uma foto enviada.<br>
      O sistema detecta os rostos no v√≠deo, compara com a imagem de refer√™ncia e verifica se a pessoa tem alguma nota√ß√£o registrada previamente.<br><br>
      <strong>Instru√ß√µes:</strong> <br>
      1Ô∏è‚É£ <a href="https://projetos.tiago.cafe/demo_images/videos.zip" target="_blank">Baixe os arquivos de exemplo</a>.<br>
      2Ô∏è‚É£ Fa√ßa o upload da foto da pessoa. <br>
      3Ô∏è‚É£ Fa√ßa o upload do v√≠deo. <br>
      4Ô∏è‚É£ Clique em <strong>Comparar Faces</strong>.<br><br>
    </div>

    <form method="POST" enctype="multipart/form-data">
      <div class="drop-section">
        <label class="drop-box" for="photo">
          <p>üì∏ Clique ou arraste a <strong>foto de refer√™ncia</strong></p>
          <input type="file" name="photo" id="photo" accept="image/*" required />
          <div class="file-status" id="photo-status"></div>
        </label>
        <label class="drop-box" for="video">
          <p>üé• Clique ou arraste o <strong>v√≠deo para an√°lise</strong></p>
          <input type="file" name="video" id="video" accept="video/mp4" required />
          <div class="file-status" id="video-status"></div>
        </label>
      </div>
      <button type="submit">üîç Comparar Faces</button>

      <div id="progress-bar-container">
        <div style="margin-bottom: 5px; color: #004080; font-size: 14px">
          ‚è≥ Processando v√≠deo e imagem (Pode levar um tempo)...
        </div>
        <div class="progress-bar-wrapper">
          <div class="progress-bar"></div>
        </div>
      </div>
    </form>

    <div>
      O resultado exibir√° os candidatos encontrados, o frame em que foram localizados, a pontua√ß√£o de similaridade e, se houver nota√ß√£o, um aviso espec√≠fico ser√° mostrado. As nota√ß√µes s√£o como alertas para pessoas espec√≠ficas, em casos de usos pr√°ticos, podem ser pessoas desaparecidas ou com algum tipo de restri√ß√£o.<br>
      <br>  <strong>Obs:</strong> Nos arquivos de exemplo, tr√™s pessoas possuem nota√ß√µes previamente cadastradas. Os exemplos s√£o v√≠deos obtidos do Youtube, respeitando a licen√ßa de reprodu√ß√£o curta. S√£o meramente exemplificativos e n√£o h√° qualquer vincula√ß√£o real a casos de uso. Foram escolhidos de maneira aleat√≥ria.
    </div>


    {% if top_faces %}
    <h2>‚úÖ Correspond√™ncias Detectadas </h2>
    {% for face in top_faces %}
      {% if face.score > 0.5 and face.similarity > 40 %}
      <div class="card match">
        <div class="score">Similaridade: {{ '%.2f'|format(face.similarity) }}% | Dist√¢ncia: {{ '%.4f'|format(face.score) }}</div>
        {% if face.observacao %}
        <div style="color: orange; font-weight: bold; margin-top: 10px;">
          ‚ö†Ô∏è Essa pessoa possui uma nota√ß√£o.
        </div>
        {% endif %}
        <div class="images">
          <div><p>Refer√™ncia</p><img src="data:image/jpeg;base64,{{ face.ref_base64 }}"></div>
          <div><p>V√≠deo - Frame {{ face.frame }}</p><img src="data:image/jpeg;base64,{{ face.video_base64 }}"></div>
        </div>
      </div>
      {% endif %}
    {% endfor %}
    {% endif %}

    {% if other_faces %}
    <h2>‚ùå Sem Correspond√™ncia Direta (Demais Casos a analisar)</h2>
    {% for face in other_faces %}
      {% if not (face.score > 0.5 and face.similarity > 45) %}
      <div class="card no-match">
        <div class="score">Similaridade: {{ '%.2f'|format(face.similarity) }}% | Dist√¢ncia: {{ '%.4f'|format(face.score) }}</div>
        <div class="images">
          <div><p>Refer√™ncia</p><img src="data:image/jpeg;base64,{{ face.ref_base64 }}"></div>
          <div><p>V√≠deo - Frame {{ face.frame }}</p><img src="data:image/jpeg;base64,{{ face.video_base64 }}"></div>
        </div>
      </div>
      {% endif %}
    {% endfor %}
    {% endif %}

    {% if not top_faces and not other_faces %}
    <p style="color: #888; text-align: center;"></p>
    {% endif %}
  </div>

  <script>
    document.querySelector("form").addEventListener("submit", function () {
      document.getElementById("progress-bar-container").style.display = "block";
    });

    document.getElementById("photo").addEventListener("change", function () {
      document.getElementById("photo-status").textContent = this.files[0] ? "‚úÖ Foto carregada: " + this.files[0].name : "";
    });

    document.getElementById("video").addEventListener("change", function () {
      document.getElementById("video-status").textContent = this.files[0] ? "‚úÖ V√≠deo carregado: " + this.files[0].name : "";
    });
  </script>
</body>
</html>
 
